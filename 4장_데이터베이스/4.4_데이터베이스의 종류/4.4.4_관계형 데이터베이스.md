# 4.4.1 관계형 데이터베이스(RDBMS)

- 행과 열을 가지는 표 형식 데이터를 저장하는 형태의 데이터베이스
- SQL(Structured Query Language)을 써서 조작
    - 표준 SQL을 지키지만 각 제품에 특화된 SQL을 사용함
        - Oracle - PL/SQL
        - SQL Server - T-SQL
        - MySQL - SQL
- 종류
    1. MySQL
    2. PostgreSQL
    3. Oracle
    4. SQL Server
    5. MSSQL
    6. SQLite

## 1. MySQL

- 대부분의 운영체제와 호환되며 현재 가장 많이 사용하는 데이터베이스
- 메타, 트위터 등 사용
- C, C++로 만들어졌음
- MyISAM 인덱스 압축 기술, B-트리 기반의 인덱스, 스레드 기반의 메모리 할당 시스템, 매우 빠른 조인, 최대 64개 인덱스 제공
- 대용량 데이터베이스를 위해 설계됨
- 롤백, 커밋, 이중 암호 지원 보안 등의 기능을 제공

![img](../../img/mysql.png)

### 1.1 MySQL 엔진

- MySQL 엔진 구성 요소
    - 커넥션 핸들러 : 접속 및 쿼리 요청을 처리
    - SQL 인터페이스 : DML, DDL, Procedure, View 등 인터페이스 제공 담당
    - SQL 파서 : SQL 문법 오류 탐지 및 SQL 쿼리 문장을 MySQL이 처리하기 좋은 토큰 단위로 나눠서 트리 형태로 파싱하는 작업 담당
    - 전처리기
    - SQL 옵티마이저 : 쿼리의 최적화된 실행 담당
    - 캐시 & 버퍼
      - 성능 향상을 위한 보조 저장소 기능 담당
      - `입력된 쿼리 문에 대한 전체 결과 집합을 저장`하기 때문에 `사용자가 작성한 쿼리가 캐시에 있는 쿼리와 일치하면` 단순히 구문 분석,최적화 및 실행을 건너뛰고 `캐쉬만 출력`
- MySQL 엔진은 SQL 문장을 분석하거나 최적화하는 등 DBMS의 두뇌 역할 수행
- 우리의 머리가 하나인 것처럼 MySQL 서버에서도 MySQL 엔진은 하나만 존재함
- 

### 1.2 스토리지 엔진

- 실제 데이터를 디스크 스토리지에 저장하거나 읽어오는 부분을 담당.
- 모듈식 아키텍처로 쉽게 스토리지 엔진을 바꿀 수 있음
- MySQL 엔진과 다르게 스토리지 엔진은 여러 개를 동시에 사용할 수 있음
- 데이터 웨어하우징, 트랜잭션 처리, 고가용성 처리에 강점
 

### 핸들러 API
- MySQL 엔진의 쿼리 실행기에서 스토리지 엔진에 쓰기 또는 읽기를 요청하는데, 이를 핸들러 요청이라고 한다.
- 이때 사용되는 API를 핸들러 API라고 부른다.
- InnoDB 스토리지 엔진 또한 핸들러 API를 이용해 MySQL 엔진과 데이터를 주고받는다.

## 2. PostgreSQL

- MySQL 다음으로 개발자들이 선호하는 데이터베이스 기술로 널리 인정받음
- 디스크 조각이 차지하는 영역을 회수할 수 있는 장치인 VACUUM이 특징
- 최대 테이블 크기 : 32TB
- SQL뿐만 아니라 JSON으로 접근 가능
- 지정된 시간에 복구하는 기능, 로깅, 접근 제어, 중첩된 트랜잭션, 백업 등을 할 수 있음

# 4.4.2 NoSQL 데이터베이스

- Not Only SQL이라는 슬로건에서 시작된 데이터베이스
- SQL을 사용하지 않는 데이터 베이스
- **종류**
    - MongoDB, redis 등

## 1. MongoDB

- JSON을 통해 데이터에 접근할 수 있음
- Binary JSON로 데이터가 저장됨
- 와이어드타이거 엔진이 기본 스토리지 엔진으로 장착된 키-값 데이터 모델에서 확장된 document기반의 데이터베이스
- 확장성이 뛰어나며 빅데이터를 저장할 때 성능이 좋고 고가용성과 **샤딩**, **레플리카셋**을 지원함
  - 샤딩 : 데이터를 여러 조각으로 나눠 저장하는 기술
  - 레플리카셋 : pod(작은 컴퓨터 단위)가 죽었을 때 미리 복제해둔 것을 바탕으로 다시 복구해줌
    - 쿠버네티스의 기능 중 하나
      - 쿠버네티스 : 컨테이너를 분산 배치, 상태 관리 및 컨테이너의 구동 환경까지 관리해 주는 도구
      - 참고 : https://www.samsungsds.com/kr/insights/220222_kubernetes1.html
- 스키마를 정해 놓지 않고 데이터를 삽입
    -  다양한 도메인의 데이터베이스를 기반으로 분석하거나 로깅을 구현할 때 강점
- 도큐먼트를 생성할 때마다 다른 컬렉션에서 중복된 값을 지니기 힘든 유티크한 값인 `objectID`가 생성됨

    ![img](../../img/MongoDBobjectID.png)
 
 ### 1.1 mongoDB의 objectID

- 12byte 크기의 문자와 숫자로 구성된 값
- 기본키로 유닉스 시간 기반의 타임스탬프(4bytes), 랜덤값(5bytes), 카운터(3bytes)로 이루어짐
    1. timestamp : 첫 4byte. Unix시대부터 초단위로 측정된 값
    2. 랜덤값 : 다음 5byte
    3. 카운터 : 다음 3byte. 증가하는 count

## 2. redis

- `인메모리 데이터베이스`이자 키-값 데이터 모델 기반의 데이터베이스
    - 인메모리 데이터베이스 : 데이터 스토리지의 메인 메모리에 설치되어 운영되는 방식의 데이터베이스 관리 시스템
    - 다양한 자료구조를 지원
      - 개발의 편의성이 좋아지고 난이도가 낮아지는 장점
- 영속성을 지원하는 인메모리 데이터 저장소
- 읽기 성능 증대를 위한 서버 측 복제를 지원
- 쓰기 성능 증대를 위한 클라이언트 측 샤딩(Sharding) 지원
- 다양한 서비스에서 사용되며 검증된 기술
- 문자열, 리스트, 해시, 셋, 정렬된 셋과 같은 다양한 데이터형을 지원.
  - 메모리 - 저장소임에도 불구하고 많은 데이터형을 지원하므로 다양한 기능을 구현
  - 개발의 편의성이 좋아지고 난이도가 낮아지는 장점
 
- 기본 데이터 타입 : 문자열(set과 hash도 지원)
- 최대 저장 용량 : 512MB
- **pub/sub 기능** 
    - publish/ subscribe :  특정한 주제(topic)에 대하여 해당 topic을 구독한 모두에게 메시지를 발행하는 통신 방법
    - push 메시지처럼 실시간으로 로그인된 사용자에게 메시지를 전달해야 하는 기능을 구성할 경우 유용
    - 채팅 기능, 다른 데이터베이스 앞단에 두어 사용하는 캐싱 계층, 단순한 키-값이 필요한 세션 정보 관리, 정렬된 셋 자료 구조를 이용한 실시간 순위표 서비스에 사용

- 한마디로 레디스는 고성능 키-값 저장소로서 문자열, 리스트, 해시, 셋, 정렬된 셋 형식의 데이터를 지원하는 NoSQL이다.